---
title: "Final Project"
output:
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, python = reticulate::eng_python)
#use_python()
```

## R Markdown

```{r}
#install.packages("arules")

library(arules)
data <- read.csv(file = "AppleStoreClean.csv", head = TRUE)
tdata <- read.transactions("AppleStoreClean.csv", quote="", sep=",")
modified_data <- data
```

## HCLUST

```{r}
distance = dist(as.matrix(data), method = "euclidean")

# perform clustering
hc = hclust(distance)

# cut the tree
clusterCut <- cutree(hc, 300)

# plot dendrogram
plot(clusterCut)

#write.csv(clusterCut, file = "C:\\Users\\samue\\Desktop\\hclust.csv")
```

## Apriori

```{r}
apprules <- apriori(tdata, parameter = list(support = 0.01, confidence = 0.35, minlen = 2))

summary(apprules)

inspect(sort(apprules, by = "lift")[1:20])

#itemFrequencyPlot(tdata, support = 0.1) # items with a support of 0.1
#itemFrequencyPlot(tdata, topN = 20) # 20 most frequent items
```

## cut data/label encoding
```{r}
data_cut <- data[, c(3, 4, 6, 8, 9)]

data2 <- read.csv(file = "AppleStoreEncoded.csv", head = TRUE)
data_encoded <- data2[, c(3, 4, 6, 8, 9)]

#for(i in 1:length(data_cut$prime_genre)) {
#  if(data_cut$prime_genre[i] == "Games") data_cut$prime_genre[i] <- 1
#}


```

## New column based on cost

```{r}
modified_data$isFree <- (data$price == 0)
free_data <- split.data.frame(modified_data, modified_data$isFree)
# print(free_data[1]) # all the not free shtuffs
```

## Bar Graph - Genres

```{r}
tbl <- with(data, table(prime_genre))
barplot(tbl, beside = TRUE, legend = FALSE, main = "Application Genres", xlab = "genre", ylab = "number")
```
